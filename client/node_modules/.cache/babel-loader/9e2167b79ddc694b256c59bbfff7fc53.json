{"ast":null,"code":"import _regeneratorRuntime from \"/workspace/nft-ticket-market/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/workspace/nft-ticket-market/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/workspace/nft-ticket-market/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/workspace/nft-ticket-market/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/workspace/nft-ticket-market/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/workspace/nft-ticket-market/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/workspace/nft-ticket-market/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/workspace/nft-ticket-market/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/workspace/nft-ticket-market/client/src/components/MyTickets.jsx\";\nimport React, { Component } from 'react';\nimport Web3 from 'web3';\nimport eventFactory from '../proxies/EventFactory';\nimport EventNFT from '../proxies/EventNFT';\nimport renderNotification from '../utils/notification-handler';\nimport { Table, Thead, Tbody, Tfoot, Tr, Th, Td, TableCaption, Text } from '@chakra-ui/react';\nvar web3;\n\nvar MyTickets = /*#__PURE__*/function (_Component) {\n  _inherits(MyTickets, _Component);\n\n  function MyTickets() {\n    var _this;\n\n    _classCallCheck(this, MyTickets);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(MyTickets).call(this));\n\n    _this.onListForSale = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n        var initiator, _this$state, ticket, price, marketplace, nftInstance;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                e.preventDefault();\n                _context.next = 4;\n                return web3.eth.getCoinbase();\n\n              case 4:\n                initiator = _context.sent;\n                _this$state = _this.state, ticket = _this$state.ticket, price = _this$state.price, marketplace = _this$state.marketplace;\n                _context.next = 8;\n                return EventNFT(_this.state.event);\n\n              case 8:\n                nftInstance = _context.sent;\n                _context.next = 11;\n                return nftInstance.methods.setSaleDetails(ticket, web3.utils.toWei(price, 'ether'), marketplace).send({\n                  from: initiator,\n                  gas: 6700000\n                });\n\n              case 11:\n                renderNotification('success', 'Success', \"Ticket is listed for sale in secondary market!\");\n                _context.next = 18;\n                break;\n\n              case 14:\n                _context.prev = 14;\n                _context.t0 = _context[\"catch\"](0);\n                console.log('Error while listing for sale', _context.t0);\n                renderNotification('danger', 'Error', _context.t0.message.split(' ').slice(8).join(' '));\n\n              case 18:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 14]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.updateEvents = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var initiator, activeEvents, eventDetails, renderData;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              _context3.next = 3;\n              return web3.eth.getCoinbase();\n\n            case 3:\n              initiator = _context3.sent;\n              _context3.next = 6;\n              return eventFactory.methods.getActiveEvents().call({\n                from: initiator\n              });\n\n            case 6:\n              activeEvents = _context3.sent;\n              _context3.next = 9;\n              return eventFactory.methods.getEventDetails(activeEvents[0]).call({\n                from: initiator\n              });\n\n            case 9:\n              eventDetails = _context3.sent;\n              _context3.next = 12;\n              return Promise.all(activeEvents.map( /*#__PURE__*/function () {\n                var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event, i) {\n                  var eventDetails;\n                  return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                    while (1) {\n                      switch (_context2.prev = _context2.next) {\n                        case 0:\n                          _context2.next = 2;\n                          return eventFactory.methods.getEventDetails(activeEvents[i]).call({\n                            from: initiator\n                          });\n\n                        case 2:\n                          eventDetails = _context2.sent;\n                          return _context2.abrupt(\"return\", /*#__PURE__*/React.createElement(\"option\", {\n                            key: event,\n                            value: event,\n                            __self: _assertThisInitialized(_assertThisInitialized(_this)),\n                            __source: {\n                              fileName: _jsxFileName,\n                              lineNumber: 64,\n                              columnNumber: 11\n                            }\n                          }, eventDetails[0]));\n\n                        case 4:\n                        case \"end\":\n                          return _context2.stop();\n                      }\n                    }\n                  }, _callee2);\n                }));\n\n                return function (_x2, _x3) {\n                  return _ref3.apply(this, arguments);\n                };\n              }()));\n\n            case 12:\n              renderData = _context3.sent;\n\n              _this.setState({\n                events: renderData,\n                event: activeEvents[0],\n                marketplace: eventDetails[4]\n              });\n\n              _this.updateTickets();\n\n              console.log('state events:', renderData);\n              _context3.next = 22;\n              break;\n\n            case 18:\n              _context3.prev = 18;\n              _context3.t0 = _context3[\"catch\"](0);\n              renderNotification('danger', 'Error', 'Error while updating the events');\n              console.log('Error while updating the events', _context3.t0);\n\n            case 22:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[0, 18]]);\n    }));\n    _this.updateTickets = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      var initiator, nftInstance, tickets, renderData;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.prev = 0;\n              _context4.next = 3;\n              return web3.eth.getCoinbase();\n\n            case 3:\n              initiator = _context4.sent;\n              _context4.next = 6;\n              return EventNFT(_this.state.event);\n\n            case 6:\n              nftInstance = _context4.sent;\n              _context4.next = 9;\n              return nftInstance.methods.getTicketsOfCustomer(initiator).call({\n                from: initiator\n              });\n\n            case 9:\n              tickets = _context4.sent;\n              renderData = tickets.map(function (ticket, i) {\n                return /*#__PURE__*/React.createElement(\"option\", {\n                  key: ticket,\n                  value: ticket,\n                  __self: _assertThisInitialized(_assertThisInitialized(_this)),\n                  __source: {\n                    fileName: _jsxFileName,\n                    lineNumber: 83,\n                    columnNumber: 9\n                  }\n                }, ticket);\n              });\n\n              _this.setState({\n                tickets: renderData,\n                ticket: tickets[0]\n              });\n\n              console.log('state tickets:', renderData);\n              _context4.next = 19;\n              break;\n\n            case 15:\n              _context4.prev = 15;\n              _context4.t0 = _context4[\"catch\"](0);\n              renderNotification('danger', 'Error', 'Error in updating the ticket for events');\n              console.log('Error in updating the ticket', _context4.t0);\n\n            case 19:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, null, [[0, 15]]);\n    }));\n\n    _this.onEventChangeHandler = /*#__PURE__*/function () {\n      var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(e) {\n        var state, event, initiator, eventDetails;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.prev = 0;\n                state = _this.state;\n                state[e.target.name] = e.target.value;\n\n                _this.setState(state);\n\n                event = _this.state.event;\n                _context5.next = 7;\n                return _this.updateTickets(event);\n\n              case 7:\n                _context5.next = 9;\n                return web3.eth.getCoinbase();\n\n              case 9:\n                initiator = _context5.sent;\n                _context5.next = 12;\n                return eventFactory.methods.getEventDetails(event).call({\n                  from: initiator\n                });\n\n              case 12:\n                eventDetails = _context5.sent;\n\n                _this.setState({\n                  marketplace: eventDetails[4]\n                });\n\n                _context5.next = 20;\n                break;\n\n              case 16:\n                _context5.prev = 16;\n                _context5.t0 = _context5[\"catch\"](0);\n                console.log('Error while tickets for event', _context5.t0.message);\n                renderNotification('danger', 'Error', 'Error while tickets for event');\n\n              case 20:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, null, [[0, 16]]);\n      }));\n\n      return function (_x4) {\n        return _ref5.apply(this, arguments);\n      };\n    }();\n\n    _this.selectHandler = function (e) {\n      _this.setState({\n        ticket: e.target.value\n      });\n    };\n\n    _this.inputChangedHandler = function (e) {\n      var state = _this.state;\n      state[e.target.name] = e.target.value;\n\n      _this.setState(state);\n    };\n\n    _this.state = {\n      tickets: [],\n      events: [],\n      ticket: null,\n      event: null,\n      marketplace: null,\n      price: null,\n      test: null\n    };\n    web3 = new Web3(window.ethereum);\n    return _this;\n  }\n\n  _createClass(MyTickets, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _context6.next = 2;\n                return this.updateEvents();\n\n              case 2:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        class: \"container center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        class: \"container\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Text, {\n        fontSize: \"4xl\",\n        style: {\n          padding: \"30px 0px 0px 10px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 11\n        }\n      }, \"My Tickets\"), /*#__PURE__*/React.createElement(Table, {\n        variant: \"simple\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Thead, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Tr, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(Th, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 17\n        }\n      }, \"Event\"), /*#__PURE__*/React.createElement(Th, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 17\n        }\n      }, \"Ticket ID\"), /*#__PURE__*/React.createElement(Th, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 17\n        }\n      }, \"Actions\"))), /*#__PURE__*/React.createElement(Tbody, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Tr, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(Td, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 17\n        }\n      }, \"Demo Account(Placeholder)\"), /*#__PURE__*/React.createElement(Td, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 17\n        }\n      }, \"dk39s9832093kx\"), /*#__PURE__*/React.createElement(Td, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 17\n        }\n      }, \"->\")))), /*#__PURE__*/React.createElement(\"form\", {\n        class: \"\",\n        onSubmit: this.onListForSale,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        class: \"left\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 13\n        }\n      }, \"Events\"), /*#__PURE__*/React.createElement(\"select\", {\n        className: \"browser-default\",\n        name: \"fest\",\n        value: this.state.event || undefined,\n        onChange: this.onEventChangeHandler,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"option\", {\n        value: \"\",\n        disabled: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 15\n        }\n      }, \"Select Event\"), this.state.fests), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 22\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 28\n        }\n      }), /*#__PURE__*/React.createElement(\"label\", {\n        class: \"left\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 13\n        }\n      }, \"Ticket Id\"), /*#__PURE__*/React.createElement(\"select\", {\n        className: \"browser-default\",\n        name: \"ticket\",\n        value: this.state.ticket || undefined,\n        onChange: this.selectHandler,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"option\", {\n        value: \"\",\n        disabled: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 15\n        }\n      }, \"Select Ticket\"), this.state.tickets), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 22\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 28\n        }\n      }), /*#__PURE__*/React.createElement(\"label\", {\n        class: \"left\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 13\n        }\n      }, \"Sale Price\"), /*#__PURE__*/React.createElement(\"input\", {\n        id: \"price\",\n        placeholder: \"Sale Price\",\n        type: \"text\",\n        className: \"input-control\",\n        name: \"price\",\n        onChange: this.inputChangedHandler,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 51\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 183\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 189\n        }\n      }), /*#__PURE__*/React.createElement(\"button\", {\n        type: \"submit\",\n        className: \"custom-btn login-btn\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 13\n        }\n      }, \"List for Sale\"))));\n    }\n  }]);\n\n  return MyTickets;\n}(Component);\n\nexport default MyTickets;","map":{"version":3,"sources":["/workspace/nft-ticket-market/client/src/components/MyTickets.jsx"],"names":["React","Component","Web3","eventFactory","EventNFT","renderNotification","Table","Thead","Tbody","Tfoot","Tr","Th","Td","TableCaption","Text","web3","MyTickets","onListForSale","e","preventDefault","eth","getCoinbase","initiator","state","ticket","price","marketplace","event","nftInstance","methods","setSaleDetails","utils","toWei","send","from","gas","console","log","message","split","slice","join","updateEvents","getActiveEvents","call","activeEvents","getEventDetails","eventDetails","Promise","all","map","i","renderData","setState","events","updateTickets","getTicketsOfCustomer","tickets","onEventChangeHandler","target","name","value","selectHandler","inputChangedHandler","test","window","ethereum","padding","undefined","fests"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Web3 from 'web3';\nimport eventFactory from '../proxies/EventFactory';\nimport EventNFT from '../proxies/EventNFT';\nimport renderNotification from '../utils/notification-handler';\nimport {\n  Table,\n  Thead,\n  Tbody,\n  Tfoot,\n  Tr,\n  Th,\n  Td,\n  TableCaption,\n  Text\n} from '@chakra-ui/react';\n\nlet web3;\n\nclass MyTickets extends Component {\n  constructor() {\n    super();\n\n    this.state = {\n      tickets: [],\n      events: [],\n      ticket: null,\n      event: null,\n      marketplace: null,\n      price: null,\n      test: null,\n    };\n\n    web3 = new Web3(window.ethereum);\n  }\n\n  async componentDidMount() {\n    await this.updateEvents();\n  }\n\n  onListForSale = async (e) => {\n    try {\n      e.preventDefault();\n      const initiator = await web3.eth.getCoinbase();\n      const { ticket, price, marketplace } = this.state;\n      const nftInstance = await EventNFT(this.state.event);\n      await nftInstance.methods.setSaleDetails(ticket, web3.utils.toWei(price, 'ether'), marketplace).send({ from: initiator, gas: 6700000 });\n\n      renderNotification('success', 'Success', `Ticket is listed for sale in secondary market!`);\n    } catch (err) {\n      console.log('Error while listing for sale', err);\n      renderNotification('danger', 'Error', err.message.split(' ').slice(8).join(' '));\n    }\n  }\n\n  updateEvents = async () => {\n    try {\n      const initiator = await web3.eth.getCoinbase();\n      const activeEvents = await eventFactory.methods.getActiveEvents().call({ from: initiator });\n      const eventDetails = await eventFactory.methods.getEventDetails(activeEvents[0]).call({ from: initiator });\n      const renderData = await Promise.all(activeEvents.map(async (event, i) => {\n        const eventDetails = await eventFactory.methods.getEventDetails(activeEvents[i]).call({ from: initiator });\n        return (\n          <option key={event} value={event} >{eventDetails[0]}</option>\n        )\n      }));\n\n      this.setState({ events: renderData, event: activeEvents[0], marketplace: eventDetails[4] });\n      this.updateTickets();\n      console.log('state events:', renderData);\n    } catch (err) {\n      renderNotification('danger', 'Error', 'Error while updating the events');\n      console.log('Error while updating the events', err);\n    }\n  }\n\n  updateTickets = async () => {\n    try {\n      const initiator = await web3.eth.getCoinbase();\n      const nftInstance = await EventNFT(this.state.event);\n      const tickets = await nftInstance.methods.getTicketsOfCustomer(initiator).call({ from: initiator });\n      const renderData = tickets.map((ticket, i) => (\n        <option key={ticket} value={ticket} >{ticket}</option>\n      ));\n\n      this.setState({ tickets: renderData, ticket: tickets[0] });\n      console.log('state tickets:', renderData);\n    } catch (err) {\n      renderNotification('danger', 'Error', 'Error in updating the ticket for events');\n      console.log('Error in updating the ticket', err);\n    }\n  }\n\n  onEventChangeHandler = async (e) => {\n    try {\n      const state = this.state;\n      state[e.target.name] = e.target.value;\n      this.setState(state);\n\n      const { event } = this.state;\n      await this.updateTickets(event);\n\n      const initiator = await web3.eth.getCoinbase();\n      const eventDetails = await eventFactory.methods.getEventDetails(event).call({ from: initiator });\n\n      this.setState({ marketplace: eventDetails[4] });\n    } catch (err) {\n      console.log('Error while tickets for event', err.message);\n      renderNotification('danger', 'Error', 'Error while tickets for event');\n    }\n  }\n\n  selectHandler = (e) => {\n    this.setState({ ticket: e.target.value });\n  }\n\n  inputChangedHandler = (e) => {\n    const state = this.state;\n    state[e.target.name] = e.target.value;\n    this.setState(state);\n  }\n\n  render() {\n    return (\n      <div class=\"container center\" >\n        <div class=\"container\">\n          <Text fontSize='4xl' style={{ padding: \"30px 0px 0px 10px\" }}>My Tickets</Text>\n          <Table variant='simple'>\n            <Thead>\n              <Tr>\n                <Th>Event</Th>\n                <Th>Ticket ID</Th>\n                <Th>Actions</Th>\n              </Tr>\n            </Thead>\n            <Tbody>\n              <Tr>\n                <Td>Demo Account(Placeholder)</Td>\n                <Td>dk39s9832093kx</Td>\n                <Td>-></Td>\n              </Tr>\n            </Tbody>\n          </Table>\n          <form class=\"\" onSubmit={this.onListForSale}>\n\n            <label class=\"left\">Events</label>\n            <select className=\"browser-default\" name='fest' value={this.state.event || undefined} onChange={this.onEventChangeHandler}>\n              <option value=\"\" disabled >Select Event</option>\n              {this.state.fests}\n            </select><br /><br />\n\n            <label class=\"left\">Ticket Id</label>\n            <select className=\"browser-default\" name='ticket' value={this.state.ticket || undefined} onChange={this.selectHandler}>\n              <option value=\"\" disabled>Select Ticket</option>\n              {this.state.tickets}\n            </select><br /><br />\n\n            <label class=\"left\">Sale Price</label><input id=\"price\" placeholder=\"Sale Price\" type=\"text\" className=\"input-control\" name=\"price\" onChange={this.inputChangedHandler} /><br /><br />\n\n            <button type=\"submit\" className=\"custom-btn login-btn\">List for Sale</button>\n          </form>\n        </div>\n      </div >\n    )\n  }\n}\n\nexport default MyTickets;"]},"metadata":{},"sourceType":"module"}